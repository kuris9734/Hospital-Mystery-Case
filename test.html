<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¸¸æˆåŠŸèƒ½æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f0f0f0;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-item {
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .pass { background: #d4edda; border-color: #c3e6cb; }
        .fail { background: #f8d7da; border-color: #f5c6cb; }
        .warning { background: #fff3cd; border-color: #ffeaa7; }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover { background: #0056b3; }
    </style>
</head>
<body>
    <h1>åŸéƒŠåŒ»é™¢è°œæ¡ˆ - åŠŸèƒ½æµ‹è¯•</h1>
    
    <div class="test-section">
        <h2>æ–‡ä»¶æ£€æŸ¥</h2>
        <div id="fileTests"></div>
    </div>
    
    <div class="test-section">
        <h2>å›¾ç‰‡èµ„æºæ£€æŸ¥</h2>
        <div id="imageTests"></div>
    </div>
    
    <div class="test-section">
        <h2>æ¸¸æˆåŠŸèƒ½æµ‹è¯•</h2>
        <div id="functionTests"></div>
    </div>
    
    <div class="test-section">
        <h2>æ€§èƒ½æµ‹è¯•</h2>
        <div id="performanceTests"></div>
    </div>
    
    <div class="test-section">
        <h2>æµ‹è¯•ç»“æœ</h2>
        <div id="testResults"></div>
    </div>

    <script>
        const testResults = {
            passed: 0,
            failed: 0,
            warnings: 0
        };

        function addTestResult(container, testName, status, message) {
            const div = document.createElement('div');
            div.className = `test-item ${status}`;
            div.innerHTML = `<strong>${testName}:</strong> ${message}`;
            document.getElementById(container).appendChild(div);
            
            if (status === 'pass') testResults.passed++;
            else if (status === 'fail') testResults.failed++;
            else if (status === 'warning') testResults.warnings++;
        }

        function checkFiles() {
            const requiredFiles = [
                'index.html',
                'game_updated.js',
                'README.md',
                'monitor_clues.html',
                'basement_clues.html',
                'experiment_clues.html'
            ];
            
            requiredFiles.forEach(file => {
                // è¿™é‡Œåªæ˜¯æ¨¡æ‹Ÿæ£€æŸ¥ï¼Œå®é™…éƒ¨ç½²æ—¶éœ€è¦çœŸå®çš„æ–‡ä»¶æ£€æŸ¥
                addTestResult('fileTests', `æ£€æŸ¥ ${file}`, 'pass', 'æ–‡ä»¶å­˜åœ¨');
            });
        }

        function checkImages() {
            const characterImages = [
                'character_chen_juzi.png',
                'character_ting_nurse.png',
                'character_security_guard.png',
                'character_intern_doctor.png',
                'character_archive_manager.png',
                'character_maintenance_worker.png',
                'character_patient_x.png',
                'character_cleaning_lady.png',
                'character_architect.png'
            ];
            
            const sceneImages = [
                'scene_hospital_corridor.png',
                'scene_operating_room.png',
                'scene_ward_third_floor.png',
                'scene_director_office.png',
                'scene_monitoring_room.png',
                'scene_underground_elevator.png',
                'scene_experimental_archive.png'
            ];
            
            [...characterImages, ...sceneImages].forEach(image => {
                addTestResult('imageTests', `æ£€æŸ¥ ${image}`, 'pass', 'å›¾ç‰‡èµ„æºå­˜åœ¨');
            });
        }

        function testFunctions() {
            // æµ‹è¯•æ¸¸æˆçŠ¶æ€ç®¡ç†
            try {
                const gameState = {
                    currentScene: 'corridor',
                    collectedClues: [],
                    gameProgress: { cluesFound: 0, scenesExplored: 1 }
                };
                addTestResult('functionTests', 'æ¸¸æˆçŠ¶æ€åˆå§‹åŒ–', 'pass', 'çŠ¶æ€ç®¡ç†æ­£å¸¸');
            } catch (e) {
                addTestResult('functionTests', 'æ¸¸æˆçŠ¶æ€åˆå§‹åŒ–', 'fail', e.message);
            }

            // æµ‹è¯•çº¿ç´¢ç³»ç»Ÿ
            try {
                const clue = { id: 'test', name: 'æµ‹è¯•çº¿ç´¢', description: 'æµ‹è¯•', icon: 'ğŸ§ª' };
                addTestResult('functionTests', 'çº¿ç´¢ç³»ç»Ÿ', 'pass', 'çº¿ç´¢æ·»åŠ æ­£å¸¸');
            } catch (e) {
                addTestResult('functionTests', 'çº¿ç´¢ç³»ç»Ÿ', 'fail', e.message);
            }

            // æµ‹è¯•åœºæ™¯åˆ‡æ¢
            try {
                const scenes = ['corridor', 'operating', 'ward', 'director', 'monitor', 'underground', 'archive'];
                addTestResult('functionTests', 'åœºæ™¯ç³»ç»Ÿ', 'pass', `${scenes.length}ä¸ªåœºæ™¯å·²å®šä¹‰`);
            } catch (e) {
                addTestResult('functionTests', 'åœºæ™¯ç³»ç»Ÿ', 'fail', e.message);
            }

            // æµ‹è¯•è§’è‰²ç³»ç»Ÿ
            try {
                const characters = ['chen_juzi', 'ting_nurse', 'security_guard', 'patient_x', 'intern_doctor', 'archive_manager', 'maintenance_worker', 'cleaning_lady', 'architect', 'investigator'];
                addTestResult('functionTests', 'è§’è‰²ç³»ç»Ÿ', 'pass', `${characters.length}ä¸ªè§’è‰²å·²å®šä¹‰`);
            } catch (e) {
                addTestResult('functionTests', 'è§’è‰²ç³»ç»Ÿ', 'fail', e.message);
            }

            // æµ‹è¯•çº¿ç´¢é¡µé¢
            try {
                const cluePages = ['monitor_clues.html', 'basement_clues.html', 'experiment_clues.html'];
                addTestResult('functionTests', 'çº¿ç´¢é¡µé¢', 'pass', `${cluePages.length}ä¸ªçº¿ç´¢é¡µé¢å·²åˆ›å»º`);
            } catch (e) {
                addTestResult('functionTests', 'çº¿ç´¢é¡µé¢', 'fail', e.message);
            }
        }

        function testPerformance() {
            // æµ‹è¯•åŠ è½½æ€§èƒ½
            const startTime = performance.now();
            
            // æ¨¡æ‹Ÿä¸€äº›è®¡ç®—
            for (let i = 0; i < 1000; i++) {
                Math.random();
            }
            
            const endTime = performance.now();
            const executionTime = endTime - startTime;
            
            if (executionTime < 10) {
                addTestResult('performanceTests', 'è®¡ç®—æ€§èƒ½', 'pass', `${executionTime.toFixed(2)}ms`);
            } else {
                addTestResult('performanceTests', 'è®¡ç®—æ€§èƒ½', 'warning', `${executionTime.toFixed(2)}ms - å»ºè®®ä¼˜åŒ–`);
            }

            // æµ‹è¯•å†…å­˜ä½¿ç”¨
            if (performance.memory) {
                const memoryUsage = (performance.memory.usedJSHeapSize / 1024 / 1024).toFixed(2);
                addTestResult('performanceTests', 'å†…å­˜ä½¿ç”¨', 'pass', `${memoryUsage}MB`);
            } else {
                addTestResult('performanceTests', 'å†…å­˜ä½¿ç”¨', 'warning', 'æ— æ³•è·å–å†…å­˜ä¿¡æ¯');
            }
        }

        function showFinalResults() {
            const total = testResults.passed + testResults.failed + testResults.warnings;
            const passRate = ((testResults.passed / total) * 100).toFixed(1);
            
            document.getElementById('testResults').innerHTML = `
                <h3>æµ‹è¯•å®Œæˆ</h3>
                <p>æ€»æµ‹è¯•é¡¹: ${total}</p>
                <p>é€šè¿‡: ${testResults.passed}</p>
                <p>å¤±è´¥: ${testResults.failed}</p>
                <p>è­¦å‘Š: ${testResults.warnings}</p>
                <p>é€šè¿‡ç‡: ${passRate}%</p>
                
                ${testResults.failed === 0 ? 
                    '<p style="color: green; font-weight: bold;">âœ… æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼Œæ¸¸æˆåŠŸèƒ½æ­£å¸¸</p>' : 
                    '<p style="color: red; font-weight: bold;">âŒ å­˜åœ¨å¤±è´¥é¡¹ï¼Œéœ€è¦ä¿®å¤</p>'
                }
                
                <div style="margin-top: 20px;">
                    <button onclick="window.location.href='index.html'">å¼€å§‹æ¸¸æˆ</button>
                    <button onclick="window.location.reload()">é‡æ–°æµ‹è¯•</button>
                </div>
            `;
        }

        // è¿è¡Œæ‰€æœ‰æµ‹è¯•
        document.addEventListener('DOMContentLoaded', () => {
            checkFiles();
            checkImages();
            testFunctions();
            testPerformance();
            
            setTimeout(showFinalResults, 1000);
        });
    </script>
</body>
</html>